<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/style.css">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="#">Logo</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Trang chủ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#registerModal">Đăng ký</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Trợ giúp</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-3">
        <img alt="" class="img-fluid" height="300" src="../img/Screenshot_1.png" width="1200" />
        <table class="table table-bordered mt-3" id="dataTable">
            <thead>
                <tr>
                    <th>STT</th>
                    <th>Mã học viên</th>
                    <th>Họ tên</th>
                    <th>Email</th>
                    <th>Tiền dịch vụ</th>
                    <th>Tiền đồ dùng</th>
                    <th>Tổng tiền</th>
                </tr>
            </thead>
            <tbody id="studentData">
                <tr>
                    <td>1</td>
                    <td>226-78631</td>
                    <td>Le Doan Nhat Thanh</td>
                    <td>nhatthanh@iuh.edu.vn</td>
                    <td>30000</td>
                    <td>10000</td>
                    <td>40000</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h2 class="text-center">Thông Tin Đăng Ký</h2>
                    <form id="registrationForm">
                        <div class="mb-3">
                            <label for="modalStudentId" class="form-label">Mã học viên:</label>
                            <input type="text" class="form-control" id="modalStudentId" required>
                            <div class="error" id="studentIdError"></div>
                        </div>
                        <div class="mb-3">
                            <label for="fullName" class="form-label">Họ tên:</label>
                            <input type="text" class="form-control" id="fullName" required>
                            <div class="error" id="nameError"></div>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email:</label>
                            <input type="email" class="form-control" id="email" required>
                            <div class="error" id="emailError"></div>
                        </div>
                        <div class="mb-3">
                            <label for="service" class="form-label">Dịch vụ:</label>
                            <select class="form-select" id="service">
                                <option value="30000" selected>Bơi</option>
                                <option value="30000">Lặn</option>
                                <option value="30000">Ngắm san hô</option>
                                <option value="30000">Bơi Nâng Cao</option>
                                <option value="30000">Nín thở</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class=" form-label">Đồ dùng:</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="swimSuit" value="10000">
                                <label class="form-check-label" for="swimSuit">Áo quần bơi - 10000</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="float" value="35000">
                                <label class="form-check-label" for="float">Bình lặn - 35000</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="circleFloat" value="25000">
                                <label class="form-check-label" for="circleFloat">Áo Phao - 25000</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="goggles" value="35000">
                                <label class="form-check-label" for="goggles">Kính Bơi - 35000</label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="itemPrice" class="form-label">Tiền đồ dùng:</label>
                            <input type="text" class="form-control" id="itemPrice" value="" readonly>
                        </div>
                        <div class="mb-3">
                            <label for="totalPrice" class="form-label">Tổng tiền:</label>
                            <input type="text" class="form-control" id="totalPrice" value="" readonly>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" id="submitForm">Thanh toán</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Hủy</button>
                </div>
            </div>
        </div>
    </div>

    <script src="../js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('submitForm').addEventListener('click', function() {
            const modalStudentId = document.getElementById('modalStudentId').value;
            const fullName = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const serviceCost = parseInt(document.getElementById('service').value);
            const swimSuitCost = document.getElementById('swimSuit').checked ? 10000 : 0;
            const floatCost = document.getElementById('float').checked ? 35000 : 0;
            const circleFloatCost = document.getElementById('circleFloat').checked ? 25000 : 0;
            const gogglesCost = document.getElementById('goggles').checked ? 35000 : 0;
            const totalCost = serviceCost + swimSuitCost + floatCost + circleFloatCost + gogglesCost;

            let isValid = true;
            const studentIdPattern = /^\d{3}-\d{5}$/;
            const studentIdError = document.getElementById('studentIdError');
            if (!studentIdPattern.test(modalStudentId)) {
                studentIdError.textContent = "Mã học viên không hợp lệ (xxx-yyyyy)";
                isValid = false;
            } else {
                studentIdError.textContent = "";
            }

            const namePattern = /^[A-Z][a-z]+ [A-Z][a-z]+( [A-Z][a-z]+)*$/;
            const nameError = document.getElementById('nameError');
            if (!namePattern.test(fullName)) {
                nameError.textContent = "Họ tên viết không dấu, phải có ít nhất 2 từ và chữ cái đầu phải viết hoa.";
                isValid = false;
            } else {
                nameError.textContent = "";
            }
            const emailPattern = /^[a-zA-Z0-9._%+-]+@iuh\.edu\.vn$/;
            const emailError = document.getElementById('emailError');
            if (!emailPattern.test(email)) {
                emailError.textContent = "Email phải có đuôi @iuh.edu.vn.";
                isValid = false;
            } else {
                emailError.textContent = "";
            }

            if (isValid) {
               
                const tableBody = document.getElementById('studentData');
                const newRow = tableBody.insertRow();
                newRow.innerHTML = `
                    <td>${tableBody.rows.length + 1}</td>
                    <td>${modalStudentId}</td>
                    <td>${fullName}</td>
                    <td>${email}</td>
                    <td>${serviceCost}</td>
                    <td>${swimSuitCost + floatCost + circleFloatCost + gogglesCost}</td>
                    <td>${totalCost}</td>
                `;
                document.getElementById('registrationForm').reset();
                const modal = bootstrap.Modal.getInstance(document.getElementById('registerModal'));
                modal.hide();
            }
        });
    </script>
</body>

</html>
